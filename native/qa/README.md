# Quality Assurance

This directory contains quality assurance tools and documentation for IReader.

## Files

### Test Scripts

- **`run_full_test_suite.sh`** - Comprehensive automated test suite
- **`regression_test_suite.sh`** - Regression tests to catch breaking changes
- **`manual_test_checklist.md`** - Manual testing checklist for releases

### Reports

- **`reports/`** - Directory for test reports (generated by test scripts)

## Usage

### Run Full Test Suite

Execute the complete automated test suite:

```bash
cd native/qa
./run_full_test_suite.sh
```

This will:
1. Run build tests
2. Execute unit tests
3. Run integration tests
4. Check performance tests
5. Verify cross-platform compatibility
6. Test features
7. Verify documentation
8. Check license compliance
9. Test installers
10. Run security tests

A detailed report will be generated in `reports/qa_report_<timestamp>.txt`.

### Run Regression Tests

Check for regressions from previous versions:

```bash
cd native/qa
./regression_test_suite.sh
```

This verifies:
- Build compatibility
- API compatibility
- Feature availability
- Configuration validity
- Documentation presence
- License files
- Installer configurations

### Manual Testing

Before each release, complete the manual testing checklist:

1. Open `manual_test_checklist.md`
2. Follow each test step
3. Check off completed items
4. Document any issues found
5. Get sign-off from tester, reviewer, and release manager

## Test Categories

### 1. Build Tests

Verify that the project builds successfully:
- Clean build
- Incremental build
- Native library compilation
- Resource packaging

### 2. Unit Tests

Test individual components:
- JNI wrapper functions
- Voice model management
- Library verification
- Error handling

### 3. Integration Tests

Test component interactions:
- Voice download and usage
- Multi-language synthesis
- Voice switching
- Long-running synthesis

### 4. Performance Tests

Measure performance metrics:
- Synthesis latency
- Memory usage
- Throughput
- Resource consumption

### 5. Cross-Platform Tests

Verify compatibility:
- Windows (x64)
- macOS (x64, ARM64)
- Linux (x64)

### 6. Feature Tests

Test user-facing features:
- TTS functionality
- Voice management
- eBook reading
- UI interactions

### 7. Security Tests

Verify security measures:
- Library verification
- Input sanitization
- Permission handling
- Data privacy

### 8. Regression Tests

Prevent breaking changes:
- API compatibility
- Feature availability
- Configuration validity
- Documentation completeness

## Test Reports

Test reports are saved in the `reports/` directory with timestamps:

```
reports/
├── qa_report_20251110_143022.txt
├── qa_report_20251110_150145.txt
└── ...
```

Each report includes:
- Test execution timestamp
- Individual test results
- Pass/fail status
- Error messages
- Summary statistics
- Overall status

## Quality Gates

Before release, ensure:

1. **All automated tests pass** (100% pass rate)
2. **Manual testing complete** (checklist signed off)
3. **No critical bugs** (P0/P1 issues resolved)
4. **Performance targets met** (< 200ms synthesis latency)
5. **Cross-platform verified** (tested on all platforms)
6. **Documentation updated** (reflects current version)
7. **License compliance verified** (all licenses included)
8. **Installers tested** (clean install/uninstall)

## Continuous Integration

These tests should be run:

### On Every Commit
- Build tests
- Unit tests
- Lint checks

### On Pull Requests
- Full test suite
- Regression tests
- Code review

### Before Release
- Full test suite
- Manual testing
- Performance testing
- Cross-platform testing
- Security audit
- License verification

## Test Environment

### Requirements

- Operating System: Windows 10+, macOS 11+, or Linux (Ubuntu 20.04+)
- Java: JDK 17 or later
- Gradle: 8.0 or later
- Native build tools (for native library tests)
- Docker (for cross-platform testing)

### Setup

1. **Install dependencies:**
   ```bash
   # Ubuntu/Debian
   sudo apt-get install openjdk-17-jdk gradle
   
   # macOS
   brew install openjdk@17 gradle
   
   # Windows
   # Install JDK 17 and Gradle manually
   ```

2. **Make scripts executable:**
   ```bash
   chmod +x run_full_test_suite.sh
   chmod +x regression_test_suite.sh
   ```

3. **Run tests:**
   ```bash
   ./run_full_test_suite.sh
   ```

## Troubleshooting

### Tests Fail to Run

**Problem**: Scripts don't execute

**Solution**:
```bash
# Make scripts executable
chmod +x *.sh

# Check for correct line endings (Unix)
dos2unix *.sh
```

### Build Tests Fail

**Problem**: Project doesn't build

**Solution**:
```bash
# Clean build
cd ../..
./gradlew clean build --no-daemon

# Check for errors
./gradlew build --stacktrace
```

### Native Library Tests Fail

**Problem**: Native libraries not found

**Solution**:
```bash
# Build native libraries
cd ../native
./build_all.sh

# Verify libraries exist
ls -la domain/src/desktopMain/resources/native/
```

### Performance Tests Fail

**Problem**: Performance targets not met

**Solution**:
1. Profile the application
2. Identify bottlenecks
3. Optimize hot paths
4. Re-run tests

## Best Practices

### Before Committing

1. Run unit tests
2. Fix any failures
3. Verify build succeeds
4. Check code style

### Before Pull Request

1. Run full test suite
2. Run regression tests
3. Update documentation
4. Add tests for new features

### Before Release

1. Run full test suite
2. Complete manual testing
3. Test on all platforms
4. Verify installers
5. Check license compliance
6. Update release notes

## Metrics

Track these metrics over time:

- **Test Coverage**: Aim for > 80%
- **Pass Rate**: Maintain 100%
- **Build Time**: Keep < 5 minutes
- **Test Execution Time**: Keep < 10 minutes
- **Bug Escape Rate**: Minimize bugs found in production

## Contact

For questions about testing:

- **Email**: qa@ireader.org
- **GitHub**: https://github.com/yourusername/ireader/issues
- **Documentation**: https://ireader.org/docs/testing

---

*Last Updated: November 10, 2025*
